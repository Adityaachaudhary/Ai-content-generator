{"ast":null,"code":"import{createSlice,createAsyncThunk}from'@reduxjs/toolkit';import axios from'axios';const API_URL='http://localhost:5000/api';// Get user from localStorage\nconst user=JSON.parse(localStorage.getItem('user'));const initialState={user:user?user:null,isError:false,isSuccess:false,isLoading:false,message:''};// Get current user\nexport const getCurrentUser=createAsyncThunk('auth/getCurrentUser',async(_,thunkAPI)=>{try{var _thunkAPI$getState$au;const token=(_thunkAPI$getState$au=thunkAPI.getState().auth.user)===null||_thunkAPI$getState$au===void 0?void 0:_thunkAPI$getState$au.token;if(!token){return thunkAPI.rejectWithValue('No token found');}const config={headers:{'x-auth-token':token}};const response=await axios.get(`${API_URL}/auth/me`,config);return response.data;}catch(error){const message=error.response&&error.response.data&&error.response.data.msg||error.message||error.toString();// Logout user if token is invalid\nif(error.response&&error.response.status===401){localStorage.removeItem('user');}return thunkAPI.rejectWithValue(message);}});// Login user (when receiving token from Google OAuth callback)\nexport const loginWithToken=createAsyncThunk('auth/loginWithToken',async(token,thunkAPI)=>{try{// Save the token to localStorage\nconst userData={token};localStorage.setItem('user',JSON.stringify(userData));// Get user details\nconst config={headers:{'x-auth-token':token}};const response=await axios.get(`${API_URL}/auth/me`,config);// Return user data along with token\nreturn{...response.data,token};}catch(error){const message=error.response&&error.response.data&&error.response.data.msg||error.message||error.toString();return thunkAPI.rejectWithValue(message);}});// Logout user\nexport const logout=createAsyncThunk('auth/logout',async()=>{localStorage.removeItem('user');});export const authSlice=createSlice({name:'auth',initialState,reducers:{reset:state=>{state.isLoading=false;state.isSuccess=false;state.isError=false;state.message='';}},extraReducers:builder=>{builder.addCase(getCurrentUser.pending,state=>{state.isLoading=true;}).addCase(getCurrentUser.fulfilled,(state,action)=>{state.isLoading=false;state.isSuccess=true;state.user={...state.user,...action.payload};}).addCase(getCurrentUser.rejected,(state,action)=>{state.isLoading=false;state.isError=true;state.message=action.payload;state.user=null;}).addCase(loginWithToken.pending,state=>{state.isLoading=true;}).addCase(loginWithToken.fulfilled,(state,action)=>{state.isLoading=false;state.isSuccess=true;state.user=action.payload;}).addCase(loginWithToken.rejected,(state,action)=>{state.isLoading=false;state.isError=true;state.message=action.payload;state.user=null;}).addCase(logout.fulfilled,state=>{state.user=null;});}});export const{reset}=authSlice.actions;export default authSlice.reducer;","map":{"version":3,"names":["createSlice","createAsyncThunk","axios","API_URL","user","JSON","parse","localStorage","getItem","initialState","isError","isSuccess","isLoading","message","getCurrentUser","_","thunkAPI","_thunkAPI$getState$au","token","getState","auth","rejectWithValue","config","headers","response","get","data","error","msg","toString","status","removeItem","loginWithToken","userData","setItem","stringify","logout","authSlice","name","reducers","reset","state","extraReducers","builder","addCase","pending","fulfilled","action","payload","rejected","actions","reducer"],"sources":["C:/Users/harsh/Desktop/Ai-content generator/frontend/src/features/auth/authSlice.jsx"],"sourcesContent":["import { createSlice, createAsyncThunk } from '@reduxjs/toolkit';\r\nimport axios from 'axios';\r\n\r\nconst API_URL = 'http://localhost:5000/api';\r\n\r\n// Get user from localStorage\r\nconst user = JSON.parse(localStorage.getItem('user'));\r\n\r\nconst initialState = {\r\n  user: user ? user : null,\r\n  isError: false,\r\n  isSuccess: false,\r\n  isLoading: false,\r\n  message: '',\r\n};\r\n\r\n// Get current user\r\nexport const getCurrentUser = createAsyncThunk(\r\n  'auth/getCurrentUser',\r\n  async (_, thunkAPI) => {\r\n    try {\r\n      const token = thunkAPI.getState().auth.user?.token;\r\n      \r\n      if (!token) {\r\n        return thunkAPI.rejectWithValue('No token found');\r\n      }\r\n\r\n      const config = {\r\n        headers: {\r\n          'x-auth-token': token,\r\n        },\r\n      };\r\n\r\n      const response = await axios.get(`${API_URL}/auth/me`, config);\r\n      return response.data;\r\n    } catch (error) {\r\n      const message = \r\n        (error.response && \r\n          error.response.data && \r\n          error.response.data.msg) ||\r\n        error.message ||\r\n        error.toString();\r\n      \r\n      // Logout user if token is invalid\r\n      if (error.response && error.response.status === 401) {\r\n        localStorage.removeItem('user');\r\n      }\r\n\r\n      return thunkAPI.rejectWithValue(message);\r\n    }\r\n  }\r\n);\r\n\r\n// Login user (when receiving token from Google OAuth callback)\r\nexport const loginWithToken = createAsyncThunk(\r\n  'auth/loginWithToken',\r\n  async (token, thunkAPI) => {\r\n    try {\r\n      // Save the token to localStorage\r\n      const userData = { token };\r\n      localStorage.setItem('user', JSON.stringify(userData));\r\n\r\n      // Get user details\r\n      const config = {\r\n        headers: {\r\n          'x-auth-token': token,\r\n        },\r\n      };\r\n\r\n      const response = await axios.get(`${API_URL}/auth/me`, config);\r\n      \r\n      // Return user data along with token\r\n      return { ...response.data, token };\r\n    } catch (error) {\r\n      const message = \r\n        (error.response && \r\n          error.response.data && \r\n          error.response.data.msg) ||\r\n        error.message ||\r\n        error.toString();\r\n      \r\n      return thunkAPI.rejectWithValue(message);\r\n    }\r\n  }\r\n);\r\n\r\n// Logout user\r\nexport const logout = createAsyncThunk('auth/logout', async () => {\r\n  localStorage.removeItem('user');\r\n});\r\n\r\nexport const authSlice = createSlice({\r\n  name: 'auth',\r\n  initialState,\r\n  reducers: {\r\n    reset: (state) => {\r\n      state.isLoading = false;\r\n      state.isSuccess = false;\r\n      state.isError = false;\r\n      state.message = '';\r\n    },\r\n  },\r\n  extraReducers: (builder) => {\r\n    builder\r\n      .addCase(getCurrentUser.pending, (state) => {\r\n        state.isLoading = true;\r\n      })\r\n      .addCase(getCurrentUser.fulfilled, (state, action) => {\r\n        state.isLoading = false;\r\n        state.isSuccess = true;\r\n        state.user = { ...state.user, ...action.payload };\r\n      })\r\n      .addCase(getCurrentUser.rejected, (state, action) => {\r\n        state.isLoading = false;\r\n        state.isError = true;\r\n        state.message = action.payload;\r\n        state.user = null;\r\n      })\r\n      .addCase(loginWithToken.pending, (state) => {\r\n        state.isLoading = true;\r\n      })\r\n      .addCase(loginWithToken.fulfilled, (state, action) => {\r\n        state.isLoading = false;\r\n        state.isSuccess = true;\r\n        state.user = action.payload;\r\n      })\r\n      .addCase(loginWithToken.rejected, (state, action) => {\r\n        state.isLoading = false;\r\n        state.isError = true;\r\n        state.message = action.payload;\r\n        state.user = null;\r\n      })\r\n      .addCase(logout.fulfilled, (state) => {\r\n        state.user = null;\r\n      });\r\n  },\r\n});\r\n\r\nexport const { reset } = authSlice.actions;\r\nexport default authSlice.reducer; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}