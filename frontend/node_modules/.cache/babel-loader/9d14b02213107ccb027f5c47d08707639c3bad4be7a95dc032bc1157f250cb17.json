{"ast":null,"code":"import React,{useEffect}from'react';import{useNavigate,useSearchParams}from'react-router-dom';import{useDispatch,useSelector}from'react-redux';import{FaCheckCircle,FaSpinner}from'react-icons/fa';import{capturePayPalOrder,getUserSubscription}from'../features/subscription/subscriptionSlice';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const PaymentSuccess=()=>{const navigate=useNavigate();const dispatch=useDispatch();const[searchParams]=useSearchParams();const orderId=searchParams.get('token');// PayPal passes the order ID as \"token\" in the URL\nconst{user}=useSelector(state=>state.auth);const{paymentStatus,isLoading,isError,message}=useSelector(state=>state.subscription);useEffect(()=>{// Redirect if user not logged in\nif(!user){navigate('/');return;}// If we have an orderId in the URL and payment is not yet completed, capture the order\nif(orderId&&paymentStatus!=='COMPLETED'){dispatch(capturePayPalOrder(orderId));}// If payment is completed, fetch the updated subscription\nif(paymentStatus==='COMPLETED'){dispatch(getUserSubscription());}},[user,navigate,dispatch,orderId,paymentStatus]);// Auto-redirect to dashboard after 5 seconds\nuseEffect(()=>{let timer;if(paymentStatus==='COMPLETED'){timer=setTimeout(()=>{navigate('/dashboard');},5000);}return()=>{if(timer)clearTimeout(timer);};},[paymentStatus,navigate]);if(isLoading){return/*#__PURE__*/_jsxs(\"div\",{className:\"max-w-4xl mx-auto px-4 py-16 text-center\",children:[/*#__PURE__*/_jsx(FaSpinner,{className:\"text-4xl text-primary-500 animate-spin mx-auto mb-6\"}),/*#__PURE__*/_jsx(\"h1\",{className:\"text-xl font-semibold text-gray-800\",children:\"Processing your payment...\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600 mt-2\",children:\"Please wait while we confirm your payment with PayPal.\"})]});}if(isError){return/*#__PURE__*/_jsx(\"div\",{className:\"max-w-4xl mx-auto px-4 py-16 text-center\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-red-50 border border-red-200 text-red-800 rounded-lg p-6 mb-6 inline-block\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-2xl font-bold mb-4\",children:\"Payment Error\"}),/*#__PURE__*/_jsx(\"p\",{className:\"mb-4\",children:message||'There was a problem processing your payment.'}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>navigate('/subscription'),className:\"bg-primary-600 text-white py-2 px-6 rounded-lg hover:bg-primary-700\",children:\"Try Again\"})]})});}return/*#__PURE__*/_jsx(\"div\",{className:\"max-w-4xl mx-auto px-4 py-16 text-center\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-green-50 border border-green-200 text-green-800 rounded-lg p-8 inline-block\",children:[/*#__PURE__*/_jsx(FaCheckCircle,{className:\"text-5xl text-green-500 mx-auto mb-6\"}),/*#__PURE__*/_jsx(\"h1\",{className:\"text-3xl font-bold mb-4\",children:\"Payment Successful!\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xl mb-6\",children:\"Thank you for your subscription.\"}),/*#__PURE__*/_jsx(\"p\",{className:\"mb-8\",children:\"Your account has been updated and you now have access to additional features. You'll be redirected to your dashboard in a few seconds.\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>navigate('/dashboard'),className:\"bg-primary-600 text-white py-3 px-8 rounded-lg hover:bg-primary-700\",children:\"Go to Dashboard\"})]})});};export default PaymentSuccess;","map":{"version":3,"names":["React","useEffect","useNavigate","useSearchParams","useDispatch","useSelector","FaCheckCircle","FaSpinner","capturePayPalOrder","getUserSubscription","jsx","_jsx","jsxs","_jsxs","PaymentSuccess","navigate","dispatch","searchParams","orderId","get","user","state","auth","paymentStatus","isLoading","isError","message","subscription","timer","setTimeout","clearTimeout","className","children","onClick"],"sources":["C:/Users/harsh/Desktop/Ai-content generator/frontend/src/pages/PaymentSuccess.jsx"],"sourcesContent":["import React, { useEffect } from 'react';\r\nimport { useNavigate, useSearchParams } from 'react-router-dom';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport { FaCheckCircle, FaSpinner } from 'react-icons/fa';\r\nimport { capturePayPalOrder, getUserSubscription } from '../features/subscription/subscriptionSlice';\r\n\r\nconst PaymentSuccess = () => {\r\n  const navigate = useNavigate();\r\n  const dispatch = useDispatch();\r\n  const [searchParams] = useSearchParams();\r\n  const orderId = searchParams.get('token'); // PayPal passes the order ID as \"token\" in the URL\r\n  \r\n  const { user } = useSelector((state) => state.auth);\r\n  const { paymentStatus, isLoading, isError, message } = useSelector(\r\n    (state) => state.subscription\r\n  );\r\n\r\n  useEffect(() => {\r\n    // Redirect if user not logged in\r\n    if (!user) {\r\n      navigate('/');\r\n      return;\r\n    }\r\n\r\n    // If we have an orderId in the URL and payment is not yet completed, capture the order\r\n    if (orderId && paymentStatus !== 'COMPLETED') {\r\n      dispatch(capturePayPalOrder(orderId));\r\n    }\r\n    \r\n    // If payment is completed, fetch the updated subscription\r\n    if (paymentStatus === 'COMPLETED') {\r\n      dispatch(getUserSubscription());\r\n    }\r\n  }, [user, navigate, dispatch, orderId, paymentStatus]);\r\n\r\n  // Auto-redirect to dashboard after 5 seconds\r\n  useEffect(() => {\r\n    let timer;\r\n    if (paymentStatus === 'COMPLETED') {\r\n      timer = setTimeout(() => {\r\n        navigate('/dashboard');\r\n      }, 5000);\r\n    }\r\n    \r\n    return () => {\r\n      if (timer) clearTimeout(timer);\r\n    };\r\n  }, [paymentStatus, navigate]);\r\n\r\n  if (isLoading) {\r\n    return (\r\n      <div className=\"max-w-4xl mx-auto px-4 py-16 text-center\">\r\n        <FaSpinner className=\"text-4xl text-primary-500 animate-spin mx-auto mb-6\" />\r\n        <h1 className=\"text-xl font-semibold text-gray-800\">Processing your payment...</h1>\r\n        <p className=\"text-gray-600 mt-2\">Please wait while we confirm your payment with PayPal.</p>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (isError) {\r\n    return (\r\n      <div className=\"max-w-4xl mx-auto px-4 py-16 text-center\">\r\n        <div className=\"bg-red-50 border border-red-200 text-red-800 rounded-lg p-6 mb-6 inline-block\">\r\n          <h1 className=\"text-2xl font-bold mb-4\">Payment Error</h1>\r\n          <p className=\"mb-4\">{message || 'There was a problem processing your payment.'}</p>\r\n          <button\r\n            onClick={() => navigate('/subscription')}\r\n            className=\"bg-primary-600 text-white py-2 px-6 rounded-lg hover:bg-primary-700\"\r\n          >\r\n            Try Again\r\n          </button>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"max-w-4xl mx-auto px-4 py-16 text-center\">\r\n      <div className=\"bg-green-50 border border-green-200 text-green-800 rounded-lg p-8 inline-block\">\r\n        <FaCheckCircle className=\"text-5xl text-green-500 mx-auto mb-6\" />\r\n        <h1 className=\"text-3xl font-bold mb-4\">Payment Successful!</h1>\r\n        <p className=\"text-xl mb-6\">Thank you for your subscription.</p>\r\n        <p className=\"mb-8\">\r\n          Your account has been updated and you now have access to additional features. \r\n          You'll be redirected to your dashboard in a few seconds.\r\n        </p>\r\n        <button\r\n          onClick={() => navigate('/dashboard')}\r\n          className=\"bg-primary-600 text-white py-3 px-8 rounded-lg hover:bg-primary-700\"\r\n        >\r\n          Go to Dashboard\r\n        </button>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default PaymentSuccess; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}